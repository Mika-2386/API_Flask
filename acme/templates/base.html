<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Работа с Данными</title>
</head>

<h1> Работа с Данными csv and xlsx</h1>
<body>

<form method=post enctype=multipart/form-data action="/upload">
  <input type=file name=file>
  <input type=submit value=Загрузить>
</form>

<h2>Доступные файлы для скачивания и удаления:</h2>
{% if files %}
    {% for filename in files %}
        <div style="margin-bottom:10px;">
            <a href="/upload/{{ filename }}" download>{{ filename }}</a>
            <!-- форма для удаления файла -->
            <form method="post" action="/delete/{{ filename }}" style="display:inline;">
                <button type="submit">Удалить</button>

            </form>
                         <!-- Кнопка для запуска анализа -->
<a href="{{ url_for('analyze_salary') }}">
    <button>Запустить анализ зарплат</button>
</a>
        </div>
    {% endfor %}
{% else %}
    <p>Нет файлов для скачивания.</p>
{% endif %}

 <h2>Настройки подключения к базе данных</h2>
    <form method="post" action="/set_params">
        <label>Хост:</label>
        <input type="text" name="host" required><br>
        <label>Порт:</label>
        <input type="number" name="port" value="5432" required><br>
        <label>База данных:</label>
        <input type="text" name="database" required><br>
        <label>Пользователь:</label>
        <input type="text" name="user" required><br>
        <label>Пароль:</label>
        <input type="password" name="password" required><br>
        <label>Название таблицы:</label>
        <input type="text" name="table_name" required><br>
        <button type="submit">Задать параметры</button>
    </form>

    <h3>Действия</h3>
    <a href="/download_table"><button type="submit">Скачать таблицу</button> </a>

    <!-- Добавьте блок для отображения анализа -->
{% if analysis_results %}
<div style="border: 1px solid #000; padding: 10px; margin-top:20px;">
    <h2>Результаты анализа таблицы </h2>
    <ul>
        <li>Средняя зарплата: {{ analysis_results.mean_salary }}</li>
        <li>Медиана зарплаты: {{ analysis_results.median_salary }}</li>
        <li>Коэффициент корреляции между id и зарплатой: {{ analysis_results.correlation }}</li>
    </ul>
</div>


<h3>Дополнительные действия</h3>
<a href="/plot{{ filename }}" target="_blank">
    <button>Построить график зарплат</button>
</a>
<a href="/generate_report{{ filename }}">
    <button>Скачать отчет</button>
</a>

{% endif %}

{% block content %}

{% endblock %}

</body>
</html>